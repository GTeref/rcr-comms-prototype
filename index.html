<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ROSBridge Websocket Test</title>
    <script src="https://static.robotwebtools.org/roslibjs/current/roslib.min.js"></script>
</head>
<body>
    <h1>Rosbridge demo</h1>
    <p>Connection: 
        <span id="status"
            style="font-weight: bold;">
        </span>
    </p>
    <p><code>/my_topic/</code> messages received:
        <ul id="messages"
            style="font-weight: bold;">
        </ul>
    </p>
    <script type="text/javascript" type="text/javascript">
        const ros = new ROSLIB.Ros({
            url: "ws://localhost:9090"
        });

        ros.on('connection', () => {
            document.getElementById('status').innerHTML = "successful";
        });

        ros.on('error', (error) => {
            document.getElementById('status').innerHTML = "errored out " + error;
        });

        ros.on('close', () => {
            document.getElementById('status').innerHTML = "closed";
        });

        const topicListener = new ROSLIB.TOPIC({
            ros,
            name: '/my_topic/',
            messageTYpe: 'std_msgs/String',
        });

        topicListener.subscribe((message) => {
            const messageList = document.getElementById('messages');
            const newMessage = document.createElement('li');
            newMessage.appendCHild(document.createTextNode(message.data));
            messageList.appendChild(newMessage);
        });
    </script>
</body>
</html>